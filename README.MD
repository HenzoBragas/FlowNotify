# FlowNotify üõçÔ∏èüì®

Bem-vindo ao FlowNotify, um projeto de exemplo que demonstra uma arquitetura de microsservi√ßos reativa para um sistema
de compras, utilizando Java, Spring Boot, e Apache Kafka.

## Vis√£o Geral da Arquitetura

O FlowNotify √© composto por dois microsservi√ßos principais que se comunicam de forma ass√≠ncrona para processar pedidos e
notificar os usu√°rios.

O fluxo de uma nova compra √© o seguinte:

Cliente ‚û°Ô∏è [POST /pedidos] ‚û°Ô∏è [Servi√ßo de Compras] ‚û°Ô∏è [Salva no PostgreSQL] ‚û°Ô∏è [Publica Evento no Kafka]
‚û°Ô∏è [Servi√ßo de Notifica√ß√£o] ‚û°Ô∏è [Envia E-mail de Confirma√ß√£o]

## üöÄ Tecnologias Utilizadas

* **Linguagem:** Java 17+
* **Framework:** Spring Boot 3.x
* **Comunica√ß√£o Ass√≠ncrona:** Spring Cloud Stream com Apache Kafka
* **Banco de Dados:** PostgreSQL
* **Persist√™ncia de Dados:** Spring Data JPA / Hibernate
* **Versionamento de Banco:** Flyway
* **Build Tool:** Maven (Projeto Multi-M√≥dulo)

## üì¶ M√≥dulos (Microsservi√ßos)

O projeto √© organizado em uma estrutura Maven multi-m√≥dulo:

### 1. `servico-compras` (Producer)

- **Responsabilidades:**
    - Expor uma API REST para receber novos pedidos (`POST /pedidos`).
    - Validar e persistir os dados do pedido no banco de dados PostgreSQL.
    - Publicar um evento `PedidoSalvoEvent` em um t√≥pico do Kafka ap√≥s cada compra bem-sucedida.
- **Porta:** `8080`

### 2. `servico-notificacao` (Consumer)

- **Responsabilidades:**
    - Ouvir o t√≥pico do Kafka para consumir os eventos `PedidoSalvoEvent`.
    - Processar o evento e utilizar o `spring-boot-starter-mail` para enviar um e-mail de confirma√ß√£o para o usu√°rio.
    - √â desacoplado e n√£o possui conhecimento sobre a l√≥gica de neg√≥cio do servi√ßo de compras.
- **Porta:** `8081`

## üõ†Ô∏è Pr√©-requisitos

Antes de come√ßar, garanta que voc√™ tenha as seguintes ferramentas instaladas:

* JDK 17 ou superior
* Apache Maven 3.8+
* Docker e Docker Compose
* Um cliente de API como Postman ou Insomnia (para testar o endpoint)

üì° Testando a API
Com ambos os servi√ßos e a infraestrutura rodando, voc√™ pode enviar uma requisi√ß√£o POST para o servico-compras para
simular um novo pedido.

Endpoint: POST http://localhost:8080/pedidos

Corpo da Requisi√ß√£o (JSON):

```
JSON

{
   "idUsuario": 101,
   "valorTotal": 529.80,
    "itens": [
   {
   "idProduto": "TEC-00123",
    "quantidade": 1,
    "precoUnitario": 350.00
   },
   {
    "idProduto": "MSE-00456",
    "quantidade": 2,
     "precoUnitario": 89.90
    }
  ]
}
```

O que esperar:

Voc√™ receber√° uma resposta 201 Created com o corpo do pedido salvo.

No console do servico-compras, voc√™ ver√° logs indicando o salvamento no banco e o envio da mensagem para o Kafka.

No console do servico-notificacao, voc√™ ver√° logs indicando o recebimento da mensagem e a tentativa de envio do e-mail.